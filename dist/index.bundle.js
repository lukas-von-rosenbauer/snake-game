(()=>{"use strict";class e{y;x;constructor(e,t){this.y=e,this.x=t}}class t{y;x;direction;constructor(e,t,a){this.y=t,this.x=e,this.direction=a}}class a{y;x;direction;constructor(e,t,a){this.y=t,this.x=e,this.direction=a}}const r=document.querySelector("canvas"),n=r.getContext("2d"),c=document.getElementById("score"),o=document.getElementById("highscore"),s=document.querySelector("button"),i=new Audio("./assets/eat_apple.wav"),l=new Audio("./assets/die.wav");let h,d=window.localStorage.getItem("maxApplesEaten")?Number.parseInt(window.localStorage.getItem("maxApplesEaten")):0;o.innerHTML=d+"";const y=e=>{l.play(),window.localStorage.setItem("maxApplesEaten",d+""),clearInterval(e)};s.addEventListener("click",(()=>{clearInterval(h),(()=>{const s=Array.from(new Array(32),(()=>Array.from(new Array(32),(()=>0))));let l=[new e(Math.floor(20*Math.random()),Math.floor(20*Math.random()))];const w=[new t(4,9,"d")],x=[];let f=0;c.innerHTML=f+"",h=setInterval((()=>{const a=w[0];s.forEach((e=>e.fill(0))),w.forEach(((e,t)=>{s[e.x][e.y]=1,x.forEach(((a,r)=>{e.x===a.x&&e.y===a.y&&(e.direction=a.direction,t===w.length-1&&x.splice(r,1))}))})),l.forEach(((a,r)=>{s[a.x][a.y]=2,w.forEach((n=>{if(a.y===n.y&&a.x===n.x){i.play(),l.splice(r,1),l.push(new e(Math.floor(20*Math.random()),Math.floor(20*Math.random()))),c.innerHTML=++f+"",d=Math.max(f,d),o.innerHTML=d+"";let a=w[w.length-1],n=[0,0];switch(a.direction){case"w":n=[0,1];break;case"a":n=[1,0];break;case"s":n=[0,-1];break;case"d":n=[-1,0]}w.push(new t(a.x+n[0],a.y+n[1],a.direction))}}))})),w.forEach(((e,t)=>{switch(e.direction){case"w":e.y--;break;case"a":e.x--;break;case"s":e.y++;break;case"d":e.x++}w.forEach(((a,r)=>{e.x===a.x&&e.y===a.y&&t!==r&&y(h)}))})),(a.x<0||a.x>20||a.y<0||a.y>20)&&y(h),n.fillRect(0,0,r.width,r.height);for(let e=0;e<20;e++)for(let t=0;t<20;t++)0===s[e][t]?n.fillStyle="BLACK":1===s[e][t]?n.fillStyle="GREEN":n.fillStyle="RED",n.fillRect(32*e,32*t,32,32),n.fillStyle="AQUA",n.fillRect(32*a.x,32*a.y,32,32),n.strokeStyle="WHITE",n.strokeRect(32*e,32*t,32,32)}),100),window.addEventListener("keydown",(e=>{switch(e.key){case"w":1!==w.length&&"s"===w[0].direction||x.push(new a(w[0].x,w[0].y,"w"));break;case"a":1!==w.length&&"d"===w[0].direction||x.push(new a(w[0].x,w[0].y,"a"));break;case"s":1!==w.length&&"w"===w[0].direction||x.push(new a(w[0].x,w[0].y,"s"));break;case"d":1!==w.length&&"a"===w[0].direction||x.push(new a(w[0].x,w[0].y,"d"))}}))})()}))})();